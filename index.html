<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>VietinBank 2/9 Countdown</title>
  <style>
    html,body{
      margin:0;height:100dvh;width:100vw;background:#000;display:grid;place-items:center;overflow:hidden;
      color:#fff;
    }
    #stage{position:fixed;inset:0;width:100vw;height:100dvh}

    /* Video Player */
    #v {
      position: fixed;
      top: 50%; left: 50%;
      min-width: 100%; min-height: 100%;
      width: auto; height: auto;
      transform: translateX(-50%) translateY(-50%);
      /* SỬA LỖI: Đổi từ cover sang contain để video không bị cắt */
      object-fit: contain;
      z-index: 10;
      display: none;
    }

    /* Countdown */
    #countdownWrap{position:fixed;inset:0;display:none;place-items:center;background:#000;z-index:30}
    #countdown{
      font-size:min(22vw,200px);font-weight:900;letter-spacing:.08em;color:#fff;
      text-shadow:0 0 28px rgba(255,255,255,.6),0 0 60px rgba(255,255,255,.35);
      animation:pulse 1.1s ease both
    }
    @keyframes pulse{0%{transform:scale(.6);filter:blur(6px);opacity:.5}60%{transform:scale(1.12);opacity:1}100%{transform:scale(1)}}

    /* === HIỆU ỨNG SLIDE MỚI === */
    #slideContainer{
      position:fixed;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;text-align:center;z-index:20;overflow:hidden;
    }
    .slide-bg {
      position: absolute;
      inset: 0;
      background-position: center;
      /* SỬA LỖI: Đổi từ cover sang contain để ảnh không bị cắt */
      background-size: contain;
      background-repeat: no-repeat;
      opacity: 0;
      transform: scale(1.1); /* Bắt đầu zoom vào */
      transition: opacity 1.5s ease-in-out; /* Thời gian mờ chồng */
    }
    .slide-bg.visible {
      opacity: 1;
      transform: scale(1); /* Zoom ra nhẹ nhàng */
    }
    #slideOverlay{position:absolute;inset:0;opacity:.6;mix-blend-mode:overlay}
    #slideText{
      position:relative;margin:0 4vw;font-family:"Times New Roman",serif;font-weight:900;
      font-size:min(12vw,72px);letter-spacing:.04em;color:#fff;
      text-shadow: 0 0 15px rgba(0,0,0,0.7);
      transition: opacity 0.75s ease-in-out;
      opacity: 0;
    }

    /* Unmute prompt */
    #unmute{
      position:fixed;inset:0;display:none;place-items:center;z-index:50;background:rgba(0,0,0,.65)
    }
    #unmute button{
      font-weight:800;padding:10px 16px;border-radius:10px;border:none;background:#1e88e5;color:#fff
    }

    audio{display:none}
  </style>
</head>
<body>
<div id="stage">
  <div id="countdownWrap"><div id="countdown"></div></div>

  <video id="v" playsinline crossorigin="anonymous"
   src="https://res.cloudinary.com/dj5uo6y8w/video/upload/v1756374279/bac-ho-2-9_pllr7b.mp4"></video>

  <div id="slideContainer">
    <div class="slide-bg" id="slideBg1"></div>
    <div class="slide-bg" id="slideBg2"></div>
    <div id="slideOverlay"></div>
    <h1 id="slideText"></h1>
  </div>

  <div id="unmute"><button id="btnUnmute">Bật âm thanh</button></div>
</div>

<audio id="bgm" loop crossorigin="anonymous"
 src="https://res.cloudinary.com/dj5uo6y8w/video/upload/v1756622154/M%C3%A1u_%C4%90%E1%BB%8F_Da_V%C3%A0ng_mp3cut.net_vhw8k0.mp3"></audio>

<script>
/* ==== DOM ==== */
const v = document.getElementById('v');
const bgm = document.getElementById('bgm');
const countdownWrap = document.getElementById('countdownWrap');
const countdown = document.getElementById('countdown');
const slideContainer = document.getElementById('slideContainer');
const slideBg1 = document.getElementById('slideBg1');
const slideBg2 = document.getElementById('slideBg2');
const slideOverlay = document.getElementById('slideOverlay');
const slideText = document.getElementById('slideText');
const unmute = document.getElementById('unmute');
const btnUnmute = document.getElementById('btnUnmute');

/* ==== SLIDE DATA ==== */
const FLAG_IMG_SRC = "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756436056/hinh-nen-co-viet-nam-cho-may-tinh-1_wwoocv.jpg";
const BG_BLUE="https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756709958/t%E1%BA%A3i_xu%E1%BB%91ng_7_ppqor8.jpg";

const introSlides = [
    { text: "PHÒNG DỊCH VỤ KHÁCH HÀNG", bgImage: BG_BLUE, overlay: "linear-gradient(180deg, rgba(0,114,188,.55), rgba(0,114,188,.55))", color: "#ffffff", duration: 2500 },
    { text: "VIETINBANK",                 bgImage: BG_BLUE, overlay: "linear-gradient(180deg, rgba(0,114,188,.55), rgba(0,114,188,.55))", color: "#ffffff", duration: 2500 },
    { text: "CHI NHÁNH BẢO LỘC",          bgImage: BG_BLUE, overlay: "linear-gradient(180deg, rgba(0,114,188,.55), rgba(0,114,188,.55))", color: "#ffffff", duration: 2500 },
    { text: "CHÚC MỪNG",                  bgImage: FLAG_IMG_SRC, overlay: "linear-gradient(180deg, rgba(218,37,29,.45), rgba(218,37,29,.45))", color: "#ff1a1a", duration: 2500 },
    { text: "ĐẠI LỄ 2/9",                 bgImage: FLAG_IMG_SRC, overlay: "linear-gradient(180deg, rgba(218,37,29,.45), rgba(218,37,29,.45))", color: "#ff1a1a", duration: 3000 },
];

const flagTextSlides = [
    { text: "Tự hào màu cờ sắc áo", duration: 2500 },
    { text: "VietinBank đồng hành cùng Tổ quốc vươn xa", duration: 3000 },
    { text: "Giữ vững niềm tin, lan tỏa khát vọng", duration: 3000 },
    { text: "Chung tay dựng xây đất nước phồn vinh", duration: 3000 },
    { text: "Vì một Việt Nam ngày càng thịnh vượng", duration: 3000 },
    { text: "Văn minh và tỏa sáng trên trường quốc tế", duration: 3500 },
].map(slide => ({ ...slide, bgImage: FLAG_IMG_SRC, overlay: "linear-gradient(180deg, rgba(218,37,29,.45), rgba(218,37,29,.45))", color: "#fff" }));

const imageAlbumSlides = [
 "https://res.cloudinary.com/dj5uo6y8w/image/upload/w_300/v1756625496/t%E1%BA%A3i_xu%E1%BB%91ng_2_rrqetv.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/w_300/v1756625495/Ho_Hoan_Kiem_Hanoi_Vietnam__Stock_Photo_-_Image_of_flag_temple__5825156_ey7vcj.jpg",

  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697607/duan-vietinbank-bao-loc-11-1606889297688_hgc9hr.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697599/cds_f_ihnztg.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697588/41696cb3-4138-4165-b525-b958055d37dc_ll9foq.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697581/85586510-6212-458e-b0cf-852dcfde1c20_lwuvej.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697637/thumbnail-logo-vietinbank_zhgkhl.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697636/t%E1%BA%A3i_xu%E1%BB%91ng_6_limepl.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697636/t%E1%BA%A3i_xu%E1%BB%91ng_mjinrb.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697609/t%E1%BA%A3i_xu%E1%BB%91ng_5_uwibxl.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697609/t%E1%BA%A3i_xu%E1%BB%91ng_3_oybocj.jpg",

  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697609/National_Liberation_Front_of_South_Vietnam_Flag_Vietnam_War_adl6hv.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697608/images_1_qbw2iu.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697608/images_uyzlbo.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697582/c369743c-f7ae-4a2d-ac8c-fdd7a548f341_qtebcs.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697581/85586510-6212-458e-b0cf-852dcfde1c20_lwuvej.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697580/219797d4-482f-4b48-a9fb-b20d32271763_iuepja.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697580/8b26d5dc-1110-4595-b7c3-a23f45fe3d62_xpw1tx.jpg",

    "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697579/7dd2a94c-198e-4c37-b163-dbfee9ef2055_gygsnp.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756697579/3b715f9b-8ec4-4b30-ad82-8824bcda0295_k5xjjk.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/v1756625496/POSTER_K%E1%BB%B6_NI%E1%BB%86M_CHI%E1%BA%BEN_TH%E1%BA%AENG_%C4%90I%E1%BB%86N_BI%C3%8AN_PH%E1%BB%A6___2024_-_Duy%C3%AAn_V%C5%A9_k9tbjn.jpg",
  "https://res.cloudinary.com/dj5uo6y8w/image/upload/w_1024/v1756625496/POSTER_K%E1%BB%B6_NI%E1%BB%86M_CHI%E1%BA%BEN_TH%E1%BA%AENG_%C4%90I%E1%BB%86N_BI%C3%8AN_PH%E1%BB%A6___2024_-_Duy%C3%AAn_V%C5%A9_k9tbjn.jpg",
].map(imgSrc => ({ text: "", bgImage: imgSrc, overlay: "linear-gradient(180deg, rgba(0,0,0,0.1), rgba(0,0,0,0.1))", duration: 3500, color: "#fff" }));

/* ===== CORE FUNCTIONS ===== */

// Countdown: 3, 2, 1...
function runCountdown(next) {
  const steps=["3","2","1"]; let i=0;
  countdownWrap.style.display='grid';
  const tick=()=>{
    if(i<steps.length){
      countdown.textContent=steps[i++];
      countdown.style.animation='none'; void countdown.offsetWidth;
      countdown.style.animation='pulse 1.1s ease both';
      setTimeout(tick, 1100);
    } else {
      countdownWrap.style.display='none';
      next && next();
    }
  }; tick();
}

// === HIỆU ỨNG SLIDE MỚI: Cross-fade + Ken Burns ===
let isBg1Active = true;
function playSlides(slides, onDone) {
  let idx = 0;
  slideContainer.style.display = 'flex';

  function showOne() {
    if (idx >= slides.length) {
        const activeBg = isBg1Active ? slideBg1 : slideBg2;
        activeBg.classList.remove('visible');
        slideText.style.opacity = 0;
        setTimeout(() => {
            slideContainer.style.display = 'none';
            onDone && onDone();
        }, 1500);
      return;
    }
    
    const s = slides[idx++];
    
    const activeBg = isBg1Active ? slideBg1 : slideBg2;
    const inactiveBg = isBg1Active ? slideBg2 : slideBg1;

    // 1. Chuẩn bị slide tiếp theo trên background đang ẩn
    inactiveBg.style.backgroundImage = `url('${s.bgImage}')`;
    
    // 2. Cập nhật chữ và overlay (cho chữ mờ đi rồi hiện ra)
    slideText.style.opacity = 0;
    setTimeout(() => {
        slideOverlay.style.background = s.overlay;
        slideText.textContent = s.text;
        slideText.style.color = s.color;
        slideText.style.opacity = 1;
    }, 750); // Hiện chữ ra ở giữa hiệu ứng chuyển cảnh

    // 3. Đặt thời gian cho hiệu ứng zoom (Ken Burns)
    const zoomDuration = s.duration / 1000;
    activeBg.style.transition = `opacity 1.5s ease-in-out, transform ${zoomDuration}s ease-out`;
    inactiveBg.style.transition = `opacity 1.5s ease-in-out, transform ${zoomDuration}s ease-out`;
    
    // 4. Bắt đầu chuyển cảnh: mờ chồng và zoom
    activeBg.classList.remove('visible');
    inactiveBg.classList.add('visible');

    // 5. Đảo vai trò của 2 background cho lần kế tiếp
    isBg1Active = !isBg1Active;
    
    // 6. Lên lịch cho slide tiếp theo
    setTimeout(showOne, s.duration);
  }
  showOne();
}


// Video player
function playMainVideo() {
  v.style.display = 'block';
  bgm.volume = 1;

  const playAll = () => {
    unmute.style.display = 'none';
    const bgmPromise = bgm.play();
    const vPromise = v.play();
    if(bgmPromise !== undefined) bgmPromise.catch(e => {});
    if(vPromise !== undefined) vPromise.catch(e => {});
  };

  v.play().then(() => {
    bgm.play().catch(()=>{});
  }).catch(() => {
    unmute.style.display = 'grid';
    btnUnmute.onclick = playAll;
  });

  v.addEventListener('ended', () => {
    v.style.display = 'none';
    playSlides(flagTextSlides, () => playSlides(imageAlbumSlides, null));
  }, { once: true });
}

/* ===== START ===== */
function startAll() {
  runCountdown(() => {
    playSlides(introSlides, playMainVideo);
  });
}

window.addEventListener('load', startAll);
</script>
</body>
</html>
